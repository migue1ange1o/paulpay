<html>
<head>
    <br><br><br>
    <br><br><br>
    <title>pay.paul.town</title>
    <link href=xmr.svg rel=icon>
    <link href=sol.svg rel=icon>
    <link href=style.css rel=stylesheet>
   

    <script>
      // Define an object to map cryptocurrency codes to their names and minimum values
      var cryptoMap = {
        "monero": {
          "name": "Monero",
          "code": "XMR",
          "svg": "xmr.svg",
          "min": "{{.MinMonero}}"
        },
        "solana": {
          "name": "Solana",
          "code": "SOL",
          "svg": "sol.svg",
          "min": "{{.MinSolana}}"
        },
        "ethereum": {
          "name": "Ethereum",
          "code": "ETH",
          "svg": "eth.svg",
          "min": "{{.MinEthereum}}"
        },
        "paint": {
          "name": "Paint",
          "code": "PAINT",
          "svg": "paint.svg",
          "min": "{{.MinPaint}}"
        },
        "hex": {
          "name": "Hexcoin",
          "code": "HEX",
          "svg": "hex.svg",
          "min": "{{.MinHex}}"
        },
        "matic": {
          "name": "Polygon",
          "code": "MATIC",
          "svg": "matic.svg",
          "min": "{{.MinPolygon}}"
        },
        "busd": {
          "name": "Binance USD",
          "code": "BUSD",
          "svg": "busd.svg",
          "min": "{{.MinBusd}}"
        },
        "shiba_inu": {
          "name": "Shiba Inu",
          "code": "SHIB",
          "svg": "shiba_inu.svg",
          "min": "{{.MinShib}}"
        },
        "pnk": {
          "name": "Kleros",
          "code": "PNK",
          "svg": "pnk.svg",
          "min": "{{.MinPnk}}"
        }
      };

        window.onload = function() {
          var linksData = JSON.parse('{{.Links}}');
          var linksDiv = document.getElementById("links");

          for (var i = 0; i < linksData.length; i++) {
            var link = linksData[i];
            var button = document.createElement("button");
            button.innerText = link.description;
            button.type = "button";
            button.onclick = (function(link) { // Create a closure by wrapping the onclick function inside another function
              return function() {
                window.open(link.url, '_blank');
              }
            })(link);
            linksDiv.appendChild(button);
          }
        };

        var buttonText = "Switch Cryptocurrency";
        var crypto = "XMR"
      
        function toggleText() {
          var select = document.getElementById("toggleSelect");
          var selectedValue = select.options[select.selectedIndex].value;

          var selectedCrypto = Object.values(cryptoMap).find(function(crypto) {
            return crypto.code === selectedValue;
          });

          var amountInput = document.getElementById("amount");
          if (selectedCrypto) {
            replaceText(selectedCrypto.name, selectedCrypto.name.toLowerCase(), selectedCrypto.code);
            imgSrc = `${selectedCrypto.svg}`;
            amountInput.setAttribute("placeholder", `${selectedCrypto.min} Minimum`);
            amountInput.setAttribute("min", `${selectedCrypto.min} Minimum`);
          }

          document.getElementById("crypto").value = selectedValue;
          select.options[select.selectedIndex].selectedIndex = 0;
          document.querySelector("#currencyIcon").setAttribute("src", imgSrc);
          document.querySelector("#currencyText").textContent = "PayPaul " + selectedCrypto.code;
          amountInput.value = "";

          // switch focus to amount input field
          document.getElementById("amount").focus();
        }


        function replaceText(newText, newTextLowercase, newTextCode) {          
          // Update the text content of the amount label
          var amountLabel = document.getElementById("amountLabel");
          amountLabel.textContent = `${newText} (${newTextCode}) Amount:`;

          // Update the text content of the header label
          var amountLabel = document.getElementById("paypaul-header");
          amountLabel.textContent = `PayPaul in ${newText}.`;
        }
 
    </script>
</head>

<body>
  <form action="/pay" method="POST">
    <h2>
    <div id="paypaul-header">PayPaul in Monero.</div>
    </h2>
    <hr>
      <div class="ticker-wrap">
        <div class="ticker">
          <div class="ticker__item"><span>XMR = ${{.XMRPrice}}</span></div>
          <div class="ticker__item"><span>ETH = ${{.ETHPrice}}</span></div>
          <div class="ticker__item"><span>SOL = ${{.SolPrice}}</span></div>
          <div class="ticker__item"><span>HEX = ${{.HexPrice}}</span></div>
          <div class="ticker__item"><span>PNK = ${{.PnkPrice}}</span></div>
          <div class="ticker__item"><span>PAINT = ${{.PaintPrice}}</span></div>
          <div class="ticker__item"><span>SHIB = ${{.ShibPrice}}</span></div>
          <div class="ticker__item"><span>MATIC = ${{.PolygonPrice}}</span></div>
          <div class="ticker__item"><span>BUSD = ${{.BusdPrice}}</span></div>
        </div>      
    </div>
    <br>
    
    <label for="name">Name:</label><br>
    <input id="name" maxlength="25" name="name" placeholder="Anonymous" type="text"><br>
    <label id="amountLabel" for="amount">Monero (XMR) Amount:</label><br>
    <input id="amount" min="{{.MinMonero}}" name="amount" placeholder="{{.MinMonero}} Minimum" step="0.0001" type="number">
    <label for="message">Message:</label><br>
    <textarea id="message" maxlength="{{.MaxChar}}" name="message" placeholder="{{.MaxChar}} Character Max" rows="6"></textarea><br>
    <label for="media">Media Link:</label><br>
  
    <input id="media" name="media" type="text" placeholder="YouTube Link (Optional)"><br><br>
    <input type="hidden" id="crypto" name="crypto" value="XMR">
    <input id="showAmount" name="showAmount" type="hidden" value="true" >
    
    <div style="display: flex; align-items: center;">
      <button id="submit" type="submit" data-original-text="Pay in Monero(XMR)" style="display: flex; align-items: center;">
        <img id="currencyIcon" src="xmr.svg" style="margin-right: 10px;">
        <span id="currencyText">PayPaul XMR</span>
      </button>
      <select id="toggleSelect" onchange="toggleText()" onblur="this.selectedIndex=0;">
        <option value="" disabled selected>Switch Cryptocurrency</option>
        <option value="XMR">Switch to Monero</option>
        <option value="SOL">Switch to Solana</option>
        <option value="ETH">Switch to Ethereum</option>
        <option value="PAINT">Switch to Paint</option>
        <option value="HEX">Switch to Hexcoin</option>
        <option value="MATIC">Switch to Polygon</option>
        <option value="BUSD">Switch to Binance USD</option>
        <option value="SHIB">Switch to Shiba Inu</option>
        <option value="PNK">Switch to Kleros</option>
      </select>
    </div>
    <br>
    <small></small><div id="links"></div></small>     
  </form>
  
  <footer>
    <small><small>
      <p>PayPaul &copy; 2023. Developed by <a href="http://www.paul.town/" target="_blank">Paul Town</a> with <a href="https://github.com/pautown/paulpay" target="_blank">PayPaul GitHub Source Code</a></p>
    </small></small>
  </footer>
</body>

</html>