<html>
<head>
    <br><br><br>
    <br><br><br>
    <title>pay.paul.town</title>
    <link href=xmr.svg rel=icon>
    <link href=sol.svg rel=icon>
    <link href=style.css rel=stylesheet>
   

    <script>
        

        window.onload = function() {
          var linksData = JSON.parse('{{.Links}}');
          var linksDiv = document.getElementById("links");

          for (var i = 0; i < linksData.length; i++) {
            var link = linksData[i];
            var button = document.createElement("button");
            button.innerText = link.description;
            button.type = "button";
            button.onclick = (function(link) { // Create a closure by wrapping the onclick function inside another function
              return function() {
                window.open(link.url, '_blank');
              }
            })(link);
            linksDiv.appendChild(button);
          }
        };


        var buttonText = "Switch Cryptocurrency";
        var mon = true;
      
        function toggleText() {
          var select = document.getElementById("toggleSelect");
          var selectedValue = select.options[select.selectedIndex].value;
          
          var mon = selectedValue === "monero";
          document.getElementById("mon").value = mon;
          
          
          
          var buttonText, imgSrc;
          if (selectedValue === "solana") {

            replaceText("Solana", "solana", "SOL")
            imgSrc = "sol.svg";
          } else if (selectedValue === "monero") {
            replaceText("Monero", "monero", "XMR")
            imgSrc = "xmr.svg";
          } else if (selectedValue === "ethereum") {
            replaceText("Ethereum", "ethereum", "ETH")
            imgSrc = "eth.svg";
          }

          select.options[select.selectedIndex].selectedIndex = 0;
          //document.getElementById("toggleButton").innerHTML = buttonText;
          document.querySelector("#currencyIcon").setAttribute("src", imgSrc);
          
          var amountInput = document.getElementById("amount");
          if (mon) {
            amountInput.setAttribute("placeholder", "{{.MinMonero}} Minimum");
          } else {
            amountInput.setAttribute("placeholder", "{{.MinSolana}} Minimum");
          }
          amountInput.value = "";

          // switch focus to amount input field
          document.getElementById("amount").focus();
        }

        function replaceText(newText, newTextLowercase, newTextCode)
        {
          var elements = document.querySelectorAll('h2, label, input, textarea, button');
          elements.forEach(function(element) {
            if (element.innerHTML.includes("Monero")) {
              element.innerHTML = element.innerHTML.replace(/Monero/g, newText);
            } else if (element.innerHTML.includes("monero")) {
              element.innerHTML = element.innerHTML.replace(/monero/g, newTextLowercase);
            } else if (element.innerHTML.includes("Solana")) {
              element.innerHTML = element.innerHTML.replace(/Solana/g, newText);
            } else if (element.innerHTML.includes("solana")) {
              element.innerHTML = element.innerHTML.replace(/solana/g, newTextLowercase);
            } else if (element.innerHTML.includes("Ethereum")) {
              element.innerHTML = element.innerHTML.replace(/Ethereum/g, newText);
            } else if (element.innerHTML.includes("ethereum")) {
              element.innerHTML = element.innerHTML.replace(/ethereum/g, newTextLowercase);
            }
              
            if (element.innerHTML.includes("XMR")) {
              element.innerHTML = element.innerHTML.replace(/XMR/g, newTextCode);
            } else if (element.innerHTML.includes("SOL")) {
              element.innerHTML = element.innerHTML.replace(/SOL/g, newTextCode);
            } else if (element.innerHTML.includes("ETH")) {
              element.innerHTML = element.innerHTML.replace(/ETH/g, newTextCode);
            }
          });
        }




      
      
      
    </script>
</head>

<body>

  <form action="/pay" method="POST">
    <h2>PayPaul in Monero.</h2>
    <hr><br><br><br>
    
    <label for="name">Name:</label><br>
    <input id="name" maxlength="25" name="name" placeholder="Anonymous" type="text"><br>
    <label for="amount">Monero (XMR) Amount:</label><br>
    <input id="amount" min="{{.MinMonero}}" name="amount" placeholder="{{.MinMonero}} Minimum" step="0.0001" type="number">
    <label for="message">Message:</label><br>
    <textarea id="message" maxlength="{{.MaxChar}}" name="message" placeholder="{{.MaxChar}} character max" rows="6"></textarea><br>
  <label for="media">Media (Optional) - Minimum donation of $5:</label><br>
  
    <input id="media" name="media" type="text" placeholder="YouTube link"><br><br>
    
  
    
    <input type="hidden" id="mon" name="mon" value=true>
    
    <button id="submit" type="submit" data-original-text="Pay in Monero(XMR)">
      <img id="currencyIcon" src="xmr.svg">Monero PayPaul
    </button>
    
    
      
    
    <select id="toggleSelect" onchange="toggleText()" onblur="this.selectedIndex=0;">
      <option value="" disabled selected>Switch Cryptocurrency</option>
      <option value="monero">Switch to Monero</option>
      <option value="solana">Switch to Solana</option>
      <option value="ethereum">Switch to Ethereum</option>
    </select>

    <input id="showAmount" name="showAmount" type="checkbox" value="true" {{.Checked}}>
    <small><label for="showAmount">Show amount on stream?</label></small>

    <div id="currencyRates">
      <p style="display: inline-block;">1 XMR = ${{.XMRPrice}}</p>
      <p style="display: inline-block; margin-left: 15px;">1 SOL = ${{.SolPrice}}</p>
      <p style="display: inline-block; margin-left: 15px;">1 ETH = ${{.ETHPrice}}</p>
     </div>


    <div id="links"></div>

     
  </form>



      
</body>

</html>
