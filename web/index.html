<html>
<head>
    <br><br><br>
    <br><br><br>
    <title>pay.paul.town</title>
    <link href=xmr.svg rel=icon>
    <link href=sol.svg rel=icon>
    <link href=style.css rel=stylesheet>
   

    <script>
        

        window.onload = function() {
          var linksData = JSON.parse('{{.Links}}');
          var linksDiv = document.getElementById("links");

          for (var i = 0; i < linksData.length; i++) {
            var link = linksData[i];
            var button = document.createElement("button");
            button.innerText = link.description;
            button.type = "button";
            button.onclick = (function(link) { // Create a closure by wrapping the onclick function inside another function
              return function() {
                window.open(link.url, '_blank');
              }
            })(link);
            linksDiv.appendChild(button);
          }
        };


        var buttonText = "Change to Monero";
        var mon = true;
      
        function toggleText() {
          mon = !mon; // Toggle the value of mon
          document.getElementById("mon").value = mon; // Update the value of the hidden input field
          var elements = document.querySelectorAll('h2, label, input, textarea, button');
          elements.forEach(function(element) {
              if (element.innerHTML.includes("Monero")) {
                  element.innerHTML = element.innerHTML.replace(/Monero/g, "Solana");
              } else if (element.innerHTML.includes("monero")) {
                  element.innerHTML = element.innerHTML.replace(/monero/g, "solana");
              } else if (element.innerHTML.includes("Solana")) {
                  element.innerHTML = element.innerHTML.replace(/Solana/g, "Monero");
              } else if (element.innerHTML.includes("solana")) {
                  element.innerHTML = element.innerHTML.replace(/solana/g, "monero");
              }
            
            if (element.innerHTML.includes("XMR")) {
                  element.innerHTML = element.innerHTML.replace(/XMR/g, "SOL");
              } else if (element.innerHTML.includes("SOL")) {
                  element.innerHTML = element.innerHTML.replace(/SOL/g, "XMR");
              } 
          });

          
          var button = document.getElementById("toggleButton");
          if (buttonText === "Switch to Monero") {
              buttonText = "Switch to Solana";
          } else {
              buttonText = "Switch to Monero";
          }
          button.innerHTML = buttonText;
          
          var img = document.querySelector("#currencyIcon");
          if (img.getAttribute("src") === "xmr.svg") {
            img.setAttribute("src", "sol.svg");
          } else {
            img.setAttribute("src", "xmr.svg");
          }


          var amountInput = document.getElementById("amount");
          if (mon) {
            amountInput.setAttribute("placeholder", "{{.MinMonero}} Minimum");
          } else {
            amountInput.setAttribute("placeholder", "{{.MinSolana}} Minimum");
          }
          amountInput.value = "";


          


      }



      
      
      
    </script>
</head>

<body>

  <form action="/pay" method="POST">
    <h2>PayPaul in Monero.</h2>
    <hr><br><br><br>
    
    <label for="name">Name:</label><br>
    <input id="name" maxlength="25" name="name" placeholder="Anonymous" type="text"><br>
    <label for="amount">Monero (XMR) Amount:</label><br>
    <input id="amount" min="{{.MinMonero}}" name="amount" placeholder="{{.MinMonero}} Minimum" step="0.0001" type="number">
    <label for="message">Message:</label><br>
    <textarea id="message" maxlength="{{.MaxChar}}" name="message" placeholder="{{.MaxChar}} character max" rows="6"></textarea><br>
  <label for="media">Media (Optional) - Minimum donation of $5:</label><br>
  
    <input id="media" name="media" type="text" placeholder="YouTube link"><br><br>
    
  
    
    <input type="hidden" id="mon" name="mon" value=true>
    
    <button id="submit" type="submit" data-original-text="Pay in Monero(XMR)">
      <img id="currencyIcon" src="xmr.svg">Monero PayPaul
    </button>
    
    <input id="showAmount" name="showAmount" type="checkbox" value="true" {{.Checked}}>
    <small><label for="showAmount">Show amount on stream?</label><small>
      
    
    <button id="toggleButton" type="button" onclick="toggleText()">Switch to Solana</button>
    <div id="currencyRates">
      <p style="display: inline-block;">1 XMR = ${{.XMRPrice}}</p>
      <p style="display: inline-block; margin-left: 15px;">1 SOL = ${{.SolPrice}}</p>
     </div>


    <div id="links"></div>

     
  </form>



      
</body>

</html>
